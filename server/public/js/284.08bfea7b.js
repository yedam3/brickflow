"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[284],{1701:function(e,t,a){var o=a(6518),r=a(9565),i=a(9306),l=a(8551),n=a(1767),s=a(9462),d=a(6319),c=a(9539),u=a(4549),h=a(6395),m=!h&&u("map",TypeError),f=s((function(){var e=this.iterator,t=l(r(this.next,e)),a=this.done=!!t.done;if(!a)return d(e,this.mapper,[t.value,this.counter++],!0)}));o({target:"Iterator",proto:!0,real:!0,forced:h||m},{map:function(e){l(this);try{i(e)}catch(t){c(this,"throw",t)}return m?r(m,this,e):new f(n(this),{mapper:e})}})},2489:function(e,t,a){var o=a(6518),r=a(9565),i=a(9306),l=a(8551),n=a(1767),s=a(9462),d=a(6319),c=a(6395),u=a(9539),h=a(4549),m=!c&&h("filter",TypeError),f=s((function(){var e,t,a,o=this.iterator,i=this.predicate,n=this.next;while(1){if(e=l(r(n,o)),t=this.done=!!e.done,t)return;if(a=e.value,d(o,i,[a,this.counter++],!0))return a}}));o({target:"Iterator",proto:!0,real:!0,forced:c||m},{filter:function(e){l(this);try{i(e)}catch(t){u(this,"throw",t)}return m?r(m,this,e):new f(n(this),{predicate:e})}})},2529:function(e){e.exports=function(e,t){return{value:e,done:t}}},3377:function(e,t,a){a.d(t,{A:function(){return f}});var o=a(641),r=a(3751);const i={class:"ag-theme-alpine",style:{height:"400px",width:"100%"}},l={class:"d-flex justify-content-end me-5"},n={class:"input-group mb-3 w-50"};function s(e,t,a,s,d,c){const u=(0,o.g2)("CModalHeader"),h=(0,o.g2)("AgGridVue"),m=(0,o.g2)("CModalBody"),f=(0,o.g2)("CButton"),p=(0,o.g2)("CModalFooter"),w=(0,o.g2)("CModal");return(0,o.uX)(),(0,o.Wv)(w,{visible:a.visible,onClose:c.close,backdrop:"static",alignment:"center",size:"xl",style:{"min-width":"1000px"}},{default:(0,o.k6)((()=>[(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.RG)(e.$slots,"header",{},(()=>[t[4]||(t[4]=(0,o.eW)("자재 목록"))]),!0)])),_:3}),(0,o.bF)(m,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",i,[(0,o.Lk)("div",l,[(0,o.Lk)("div",n,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>d.searchType=e),class:"form-select","aria-label":"Default select example"},t[5]||(t[5]=[(0,o.Lk)("option",{value:"mat_code",selected:""},"자재코드",-1),(0,o.Lk)("option",{value:"mat_name"},"자재명",-1)]),512),[[r.u1,d.searchType]]),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>d.searchText=e),placeholder:"검색어 입력",class:"form-control w-50",style:{width:"30%"},onKeydown:t[2]||(t[2]=(0,r.jR)(((...e)=>c.searchMaterials&&c.searchMaterials(...e)),["enter"]))},null,544),[[r.Jo,d.searchText]]),(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>c.searchMaterials&&c.searchMaterials(...e)),class:"btn btn-primary"},t[6]||(t[6]=[(0,o.Lk)("i",{class:"pi pi-search"},null,-1)]))])]),(0,o.bF)(h,{style:{width:"100%",height:"100%"},class:"ag-theme-alpine",columnDefs:d.columnDefs,rowData:d.rowData,gridOptions:d.gridOptions,onRowClicked:c.clicked},null,8,["columnDefs","rowData","gridOptions","onRowClicked"])])])),_:1}),(0,o.bF)(p,null,{default:(0,o.k6)((()=>[(0,o.RG)(e.$slots,"footer",{},(()=>[(0,o.bF)(f,{color:"secondary",onClick:c.close},{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)("닫기")]))),_:1},8,["onClick"])]),!0)])),_:3})])),_:3},8,["visible","onClose"])}var d=a(7654),c=a(4335),u={components:{AgGridVue:d.b},props:{visible:{type:Boolean,required:!0}},data(){return{rowData:[],searchType:"mat_code",searchText:"",columnDefs:[{field:"mat_code",headerName:"자재코드",flex:1},{field:"mat_name",headerName:"자재명",flex:1},{field:"unit",headerName:"단위",flex:1},{field:"by_unit_number",headerName:"단위별 갯수",flex:1,valueFormatter:e=>null!=e.value?`${e.value}개`:""},{field:"size",headerName:"크기",flex:1},{field:"safe_inventory",headerName:"안전재고",flex:1,valueFormatter:e=>null!=e.value?`${e.value}개`:""}],gridOptions:{domLayout:"autoHeight",singleClickEdit:!0,suppressRowClickSelection:!0,pagination:!0,paginationPageSize:5,paginationPageSizeSelector:!1,overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,cellStyle:{textAlign:"center"}}}}},mounted(){this.matList()},methods:{close(){this.$emit("close")},matList(){c.A.get("/api/mat/matList").then((e=>{this.rowData=e.data})).catch((e=>{console.error(e)}))},searchMaterials(){c.A.get("/api/mat/matList",{params:{type:this.searchType,keyword:this.searchText}}).then((e=>{this.rowData=e.data})).catch((e=>{console.error(e)}))},clicked(e){this.$emit("selectMat",e.data),this.close()}}},h=a(6262);const m=(0,h.A)(u,[["render",s],["__scopeId","data-v-0dfc3e8d"]]);var f=m},6279:function(e,t,a){var o=a(6840);e.exports=function(e,t,a){for(var r in t)o(e,r,t[r],a);return e}},6319:function(e,t,a){var o=a(8551),r=a(9539);e.exports=function(e,t,a,i){try{return i?t(o(a)[0],a[1]):t(a)}catch(l){r(e,"throw",l)}}},9284:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var o=a(3377),r=a(5122),i=a(641);const l={class:"card border-0 h-100"},n={class:"text-end mt-3 mb-3",style:{"padding-right":"4%"}},s={class:"par-grid"},d={class:"prod-grid"},c={class:"bom-grid"};function u(e,t,a,u,h,m){const f=r.A,p=(0,i.g2)("ag-grid-vue"),w=o.A;return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",l,[t[3]||(t[3]=(0,i.Lk)("div",{class:"font-semibold text-xl mb-4"},"BOM 관리",-1)),t[4]||(t[4]=(0,i.Lk)("div",{class:"d-flex justify-content-start me-5"},null,-1)),(0,i.Lk)("div",n,[(0,i.bF)(f,{label:"초기화",severity:"help",class:"me-3",onClick:m.resetList},null,8,["onClick"]),(0,i.bF)(f,{label:"저장",severity:"info",class:"me-3",onClick:m.bomSave},null,8,["onClick"]),(0,i.bF)(f,{label:"행추가",severity:"success",class:"me-3",onClick:m.addRow},null,8,["onClick"]),(0,i.bF)(f,{label:"행삭제",severity:"danger",class:"me-3",onClick:m.deleteRow},null,8,["onClick"])]),(0,i.Lk)("div",s,[(0,i.Lk)("div",d,[t[1]||(t[1]=(0,i.Lk)("h5",null,"제품목록",-1)),(0,i.bF)(p,{style:{width:"700px",height:"500px"},class:"ag-theme-alpine",columnDefs:h.columnDefs,rowData:h.rowData,gridOptions:h.gridOptions,defaultColDef:e.defaultColDef,onCellClicked:m.prodCellClicked},null,8,["columnDefs","rowData","gridOptions","defaultColDef","onCellClicked"])]),(0,i.Lk)("div",c,[t[2]||(t[2]=(0,i.Lk)("h5",null,"BOM목록",-1)),(0,i.bF)(p,{style:{width:"700px",height:"500px"},ref:"secondGrid",class:"ag-theme-alpine",columnDefs:h.columnDefs2,rowData:h.rowData2,gridOptions:h.gridOptions,rowSelection:"multiple",defaultColDef:e.defaultColDef2,onCellClicked:m.bomCellClicked},null,8,["columnDefs","rowData","gridOptions","defaultColDef","onCellClicked"])])])]),(0,i.bF)(w,{visible:h.showMatModal,rowSelection:"multiple",onClose:t[0]||(t[0]=e=>h.showMatModal=!1),onSelectMat:m.matSelected},null,8,["visible","onSelectMat"])],64)}a(4114),a(8111),a(2489),a(1701);var h=a(7654),m=a(4335),f=a(8465),p=a.n(f),w={components:{AgGridVue:h.b,MatModal:o.A,Swal:p()},data(){return{rowData:[],columnDefs:[{field:"prod_code",headerName:"제품코드",flex:1,editable:!0},{field:"prod_name",headerName:"제품명",flex:1}],gridOptions:{pagination:!0,paginationPageSize:5,paginationPageSizeSelector:[5,10,20,50],overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,onGridReady:function(e){e.api.sizeColumnsToFit()}}},rowData2:[{mat_code:"",prod_code:"",prod_name:"",mat_name:"",quantity:""}],columnDefs2:[{headerCheckboxSelection:!0,checkboxSelection:!0,width:50},{field:"mat_code",headerName:"자재코드",flex:3,editable:!0},{field:"prod_code",headerName:"제품코드",flex:3,editable:!0},{field:"prod_name",headerName:"제품명",flex:4,editable:!0},{field:"mat_name",headerName:"자재명 ",flex:3,editable:!0},{field:"quantity",headerName:"수량 ",flex:2,editable:!0}],gridOptions:{domLayout:"autoHeight",suppressRowClickSelection:!0,overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,onGridReady:function(e){e.api.sizeColumnsToFit()}}},showMatModal:!1,selectedSecondIndex:null,prodIndex:null}},mounted(){this.BomData()},methods:{async BomData(){try{const e=await m.A.get("/api/admin/bom");this.rowData=e.data}catch(e){console.error("데이터 조회 실패:",e)}},prodCellClicked(e){let t=e.data.prod_code;this.prodIndex=e.rowIndex,m.A.get("/api/admin/bom/"+t).then((e=>{console.log(e),this.rowData2=e.data,this.rowData2=[...this.rowData2]})).catch((e=>{console.error(e)})),console.log(e)},addRow(){null!=this.prodIndex?(this.rowData2.push({mat_code:"",prod_code:this.rowData[this.prodIndex].prod_code,prod_name:this.rowData[this.prodIndex].prod_name,mat_name:"",quantity:""}),this.rowData2=[...this.rowData2]):p().fire({title:"실패",text:"제품을 클릭해주세요",icon:"error",confirmButtonText:"확인"})},deleteRow(){const e=this.$refs.secondGrid.api.getSelectedNodes(),t=e.map((e=>e.data));this.rowData2=this.rowData2.filter((e=>!t.includes(e)))},bomCellClicked(e){"mat_code"!=e.colDef.field&&"mat_name"!=e.colDef.field||(this.selectedSecondIndex=e.rowIndex,this.showMatModal=!0)},matSelected(e){for(let t of this.rowData2)if(t.mat_code==e.mat_code)return void p().fire({title:"실패",text:"같은 자재를 기입할 수 없습니다.",icon:"error",confirmButtonText:"확인"});this.rowData2[this.selectedSecondIndex].mat_code=e.mat_code,this.rowData2[this.selectedSecondIndex].mat_name=e.mat_name,this.rowData2=[...this.rowData2]},async bomSave(){for(let e of this.rowData2)if(console.log(e),""==e.mat_code||""==e.prod_code||""==e.prod_name||""==e.mat_name||0==e.quantity)return void p().fire({title:"실패",text:"값을 다 입력해주세요",icon:"error",confirmButtonText:"확인"});console.log(this.rowData[this.prodIndex]);m.A.post("/api/admin/bomsave",{insertBom:this.rowData2,prodBom:this.rowData[this.prodIndex].prod_code}).then((e=>{e.data.affectedRows>0?p().fire({title:"등록 성공",text:"정상적으로 등록이 완료되었습니다.",icon:"success",confirmButtonText:"확인"}):p().fire({title:"등록 실패",text:"등록이 실패하였습니다..",icon:"error",confirmButtonText:"확인"})})).catch((e=>{console.error(e),p().fire({title:"등록 실패",text:"알수 없는 오류가 발생하였습니다..",icon:"error",confirmButtonText:"확인"})}));this.rowData2=[{mat_code:"",prod_name:"",mat_name:"",quantity:""}],this.BomData()},resetList(){this.rowData2=[]}}},x=a(6262);const v=(0,x.A)(w,[["render",u],["__scopeId","data-v-1dbea1c8"]]);var g=v},9462:function(e,t,a){var o=a(9565),r=a(2360),i=a(6699),l=a(6279),n=a(8227),s=a(1181),d=a(5966),c=a(7657).IteratorPrototype,u=a(2529),h=a(9539),m=n("toStringTag"),f="IteratorHelper",p="WrapForValidIterator",w=s.set,x=function(e){var t=s.getterFor(e?p:f);return l(r(c),{next:function(){var a=t(this);if(e)return a.nextHandler();if(a.done)return u(void 0,!0);try{var o=a.nextHandler();return a.returnHandlerResult?o:u(o,a.done)}catch(r){throw a.done=!0,r}},return:function(){var a=t(this),r=a.iterator;if(a.done=!0,e){var i=d(r,"return");return i?o(i,r):u(void 0,!0)}if(a.inner)try{h(a.inner.iterator,"normal")}catch(l){return h(r,"throw",l)}return r&&h(r,"normal"),u(void 0,!0)}})},v=x(!0),g=x(!1);i(g,m,"Iterator Helper"),e.exports=function(e,t,a){var o=function(o,r){r?(r.iterator=o.iterator,r.next=o.next):r=o,r.type=t?p:f,r.returnHandlerResult=!!a,r.nextHandler=e,r.counter=0,r.done=!1,w(this,r)};return o.prototype=t?v:g,o}}}]);
//# sourceMappingURL=284.08bfea7b.js.map