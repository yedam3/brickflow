"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[682],{2772:function(a,e,t){t.d(e,{A:function(){return c}});var l=t(641);const o=["value"];function i(a,e,t,i,r,n){return(0,l.uX)(),(0,l.CE)("input",{type:"date",value:t.value,onInput:e[0]||(e[0]=(...a)=>n.onInput&&n.onInput(...a)),onBlur:e[1]||(e[1]=(...a)=>n.onBlur&&n.onBlur(...a)),class:"ag-input"},null,40,o)}var r={props:["value"],data(){return{internalValue:this.value}},methods:{onInput(a){this.internalValue=a.target.value},onBlur(){this.params.stopEditing()},getValue(){return this.internalValue}},mounted(){this.internalValue=this.params.value}},n=t(6262);const s=(0,n.A)(r,[["render",i]]);var c=s},9301:function(a,e,t){t.r(e),t.d(e,{default:function(){return B}});var l=t(5122),o=t(641),i=t(3751),r=t(33);const n={class:"card border-0",style:{height:"calc(50vh - 5rem)"}},s={class:"row g-3"},c={class:"col-md-4"},d={class:"col-md-4"},u={class:"col-md-4"},m={class:"col-md-4"},f={class:"col-md-4"},p={class:"col-md-4"},h={class:"col-md-4"},g=["value"],w={class:"col-md-4"},v=["value"],_={class:"col-md-4"},y={key:0,class:"col-md-4"},k=["src"],D={class:"text-muted d-block mt-2",style:{"font-size":"small"}},b={class:"d-flex justify-content-end mt-4 gap-3"},L={class:"card border-0",style:{height:"calc(50vh - 5rem)"}};function F(a,e,t,F,C,A){const I=l.A,x=(0,o.g2)("ag-grid-vue");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",n,[e[23]||(e[23]=(0,o.Lk)("h2",null,"설비 관리",-1)),e[24]||(e[24]=(0,o.Lk)("div",{class:"heading-with-line mb-3"},[(0,o.Lk)("h5",{class:"m-0 me-3"},"설비 등록")],-1)),(0,o.Lk)("div",s,[(0,o.Lk)("div",c,[e[11]||(e[11]=(0,o.Lk)("label",{class:"form-label"},"설비코드",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=a=>C.rowData.fac_code=a),readonly:""},null,512),[[i.Jo,C.rowData.fac_code]])]),(0,o.Lk)("div",d,[e[12]||(e[12]=(0,o.Lk)("label",{class:"form-label"},[(0,o.eW)("설비이름"),(0,o.Lk)("small",{style:{color:"gray"}},"(필수)")],-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=a=>C.rowData.model_name=a)},null,512),[[i.Jo,C.rowData.model_name]])]),(0,o.Lk)("div",u,[e[13]||(e[13]=(0,o.Lk)("label",{class:"form-label"},"설비위치",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=a=>C.rowData.fac_location=a)},null,512),[[i.Jo,C.rowData.fac_location]])]),(0,o.Lk)("div",m,[e[14]||(e[14]=(0,o.Lk)("label",{class:"form-label"},"담당자",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=a=>C.rowData.employee_name=a),readonly:""},null,512),[[i.Jo,C.rowData.employee_name]])]),(0,o.Lk)("div",f,[e[15]||(e[15]=(0,o.Lk)("label",{class:"form-label"},[(0,o.eW)("설치일자"),(0,o.Lk)("small",{style:{color:"gray"}},"(필수)")],-1)),(0,o.bo)((0,o.Lk)("input",{type:"date",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=a=>C.rowData.install_date=a)},null,512),[[i.Jo,C.rowData.install_date]])]),(0,o.Lk)("div",p,[e[16]||(e[16]=(0,o.Lk)("label",{class:"form-label"},[(0,o.eW)("점검주기"),(0,o.Lk)("small",{style:{color:"gray"}},"(월)")],-1)),(0,o.bo)((0,o.Lk)("input",{type:"number",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=a=>C.rowData.inspection_cycle=a),min:"0",onKeydown:e[6]||(e[6]=(...a)=>A.allowOnlyNumber&&A.allowOnlyNumber(...a))},null,544),[[i.Jo,C.rowData.inspection_cycle]])]),(0,o.Lk)("div",h,[e[18]||(e[18]=(0,o.Lk)("label",{class:"form-label"},[(0,o.eW)("설비유형"),(0,o.Lk)("small",{style:{color:"gray"}},"(필수)")],-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>C.rowData.fac_pattern=a),class:"form-select"},[e[17]||(e[17]=(0,o.Lk)("option",{disabled:"",value:"",style:{color:"gray"}},"선택",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(C.facPatternAry,(a=>((0,o.uX)(),(0,o.CE)("option",{key:a.fac_pattern,value:a.fac_pattern},(0,r.v_)(a.sub_code_name),9,g)))),128))],512),[[i.u1,C.rowData.fac_pattern]])]),(0,o.Lk)("div",w,[e[20]||(e[20]=(0,o.Lk)("label",{class:"form-label"},[(0,o.eW)("설비상태"),(0,o.Lk)("small",{style:{color:"gray"}},"(필수)")],-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":e[8]||(e[8]=a=>C.rowData.fac_status=a),class:"form-select"},[e[19]||(e[19]=(0,o.Lk)("option",{disabled:"",value:"",style:{color:"gray"}},"선택",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(C.facStatusAry,(a=>((0,o.uX)(),(0,o.CE)("option",{key:a.fac_status,value:a.fac_status},(0,r.v_)(a.sub_code_name),9,v)))),128))],512),[[i.u1,C.rowData.fac_status]])]),(0,o.Lk)("div",_,[e[21]||(e[21]=(0,o.Lk)("label",{class:"form-label"},"설비 이미지 업로드",-1)),(0,o.Lk)("input",{type:"file",name:"image",class:"form-control",onChange:e[9]||(e[9]=(...a)=>A.onImageChange&&A.onImageChange(...a)),ref:"fileInput",accept:"image/png, image/jpeg"},null,544)]),C.rowData.imagePreview?((0,o.uX)(),(0,o.CE)("div",y,[e[22]||(e[22]=(0,o.Lk)("label",{class:"form-label d-block"},"미리보기",-1)),(0,o.Lk)("img",{src:C.rowData.imagePreview||A.getImageUrl(C.rowData.image),alt:"설비 이미지",class:"img-thumbnail",style:{width:"400px",height:"300px",cursor:"pointer"},onClick:e[10]||(e[10]=(...a)=>A.openImageModal&&A.openImageModal(...a))},null,8,k),(0,o.Lk)("small",D,"파일명: "+(0,r.v_)(C.rowData.image),1)])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",b,[(0,o.bF)(I,{label:"초기화",severity:"secondary",onClick:A.clearForm},null,8,["onClick"]),(0,o.bF)(I,{label:"등록",severity:"info",onClick:A.addFac},null,8,["onClick"]),(0,o.bF)(I,{label:"수정",severity:"warning",onClick:A.updateFac},null,8,["onClick"]),(0,o.bF)(I,{label:"삭제",severity:"danger",onClick:A.deleteFac},null,8,["onClick"])])]),(0,o.Lk)("div",L,[e[25]||(e[25]=(0,o.Lk)("div",{class:"heading-with-line mb-3"},[(0,o.Lk)("h5",{class:"m-0 me-3"},"설비 목록")],-1)),(0,o.bF)(x,{class:"ag-theme-alpine custom-grid-theme",style:{width:"100%",height:"300px"},columnDefs:C.columnDefs,rowData:C.rowData2,gridOptions:C.gridOptions,onRowClicked:A.clicked},null,8,["columnDefs","rowData","gridOptions","onRowClicked"])])],64)}var C=t(7654),A=t(2772),I=t(4335),x=t(8465),N=t.n(x),P=t(4783),S={components:{AgGridVue:C.b,datePicker:A.A},data(){return{rowData:{fac_code:"",model_name:"",fac_location:"",employee_code:(0,P.k)().id,employee_name:(0,P.k)().empName,fac_pattern:"",install_date:"",inspection_cycle:"",image:"",imagePreview:"",fac_status:""},imageFile:null,rowData2:[{fac_code:"",model_name:"",fac_location:"",employee_code:(0,P.k)().id,employee_name:(0,P.k)().empName,fac_pattern:"",install_date:"",inspection_cycle:"",image:"",fac_status:""}],columnDefs:[{field:"fac_code",headerName:"설비코드",flex:3},{field:"model_name",headerName:"설비이름",flex:3},{field:"fac_location",headerName:"설비 위치",flex:3},{field:"employee_code",headerName:"담당자",flex:3,valueFormatter:a=>a.data?.employee_name||a.value},{field:"fac_pattern",headerName:"설비유형",flex:3,valueFormatter:a=>"FC1"==a.value?a.value="사출 성형기":"FC2"==a.value?a.value="자동 조립 장비":"FC3"==a.value?a.value="도장":"FC4"==a.value?a.value="포장 설비":"FC5"==a.value?a.value="품질 검사 설비":"FC6"==a.value?a.value="물류 운반 설비":"FC7"==a.value?a.value="정밀 금형 관리":void 0},{field:"install_date",headerName:"설치일자",flex:3},{field:"inspection_cycle",headerName:"점검주기",flex:3},{field:"image",headerName:"이미지",flex:3},{field:"fac_status",headerName:"설비상태",flex:3,valueFormatter:a=>"FS2"==a.value?a.value="비가동":"FS1"==a.value?a.value="가동":void 0,cellStyle:a=>"FS1"==a.value?{color:"#22C55E",textAlign:"center",fontWeight:"bold"}:"FS2"==a.value?{color:"red",textAlign:"center",fontWeight:"bold"}:null}],gridOptions:{domLayout:"autoHeight",singleClickEdit:!0,suppressRowClickSelection:!0,pagination:!0,paginationPageSize:5,paginationPageSizeSelector:!1,overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,cellStyle:{textAlign:"center"}}},facStatusAry:[],facPatternAry:[]}},mounted(){this.autoFacCode(),this.facList(),this.facPattern(),this.statusFac()},methods:{allowOnlyNumber(a){const e=["Backspace","Tab","ArrowLeft","ArrowRight","Delete","Home","End"],t=a.key>="0"&&a.key<="9";t||e.includes(a.key)||a.preventDefault()},openImageModal(){N().fire({imageUrl:this.rowData.imagePreview,imageWidth:600,imageHeight:450,showConfirmButton:!1,showCloseButton:!0})},async autoFacCode(){const a=await I.A.get("/api/fac/autoFacCode");this.rowData.fac_code=a.data[0].fac_code},clearForm(){this.rowData={fac_code:"",model_name:"",fac_location:"",employee_code:(0,P.k)().id,employee_name:(0,P.k)().empName,fac_pattern:"",install_date:"",inspection_cycle:"",image:"",fac_status:"",imagePreview:""},this.imageFile=null,this.$refs.fileInput&&(this.$refs.fileInput.value=""),this.autoFacCode()},async facList(){await I.A.get("/api/fac/facList").then((a=>{console.log(a.data),this.rowData2=a.data}))},async facPattern(){await I.A.get("/api/fac/facPattern").then((a=>{this.facPatternAry=a.data,this.facPatternAry=[...a.data]})).catch((a=>console.log(a)))},async statusFac(){await I.A.get("/api/fac/statusFac").then((a=>{this.facStatusAry=a.data,this.facStatusAry=[...a.data]})).catch((a=>console.log(a)))},clicked(a){const e=a.data;this.rowData={...e},e.image?this.rowData.imagePreview=this.getImageUrl(e.image):this.rowData.imagePreview="",this.imageFile=null},async addFac(){if(!this.rowData.fac_pattern&&!this.rowData.fac_status&&!this.rowData.install_date&&!this.rowData.model_name)return void N().fire("입력 오류","필수 항목을 모두 입력해주세요.","warning");if(!this.rowData.fac_pattern)return void N().fire("입력 오류","설비유형을 선택해주세요.","warning");if(!this.rowData.fac_status)return void N().fire("입력 오류","설비상태를 선택해주세요.","warning");if(!this.rowData.install_date)return void N().fire("입력 오류","설치일자를 입력해주세요.","warning");if(!this.rowData.model_name)return void N().fire("입력 오류","설비이름을 입력해주세요.","warning");const a=await this.uploadImage();a&&(this.rowData.image=a);const e=await I.A.post("/api/fac/addFac",{facCode:{...this.rowData,employee_code:(0,P.k)().id}}).catch((a=>(console.error("등록 실패:",a),N().fire("등록 실패","설비 등록 중 오류가 발생했습니다.","error"),null)));e&&e.data&&e.data.affectedRows>0?(N().fire("등록성공","정상적으로 등록되었습니다.","success").then((()=>{this.facList(),this.clearForm(),this.autoFacCode()})),this.imageFile=null,this.$refs.fileInput&&(this.$refs.fileInput.value="")):e&&N().fire("등록 실패","등록이 실패하였습니다.","error")},async uploadImage(){if(!this.imageFile)return null;const a=new FormData;a.append("image",this.imageFile);const e=await I.A.post("http://localhost:8099/api/fac/uploadImage",a,{headers:{"Content-Type":"multipart/form-data"}}).catch((a=>(console.error("이미지 업로드 실패:",a),N().fire("업로드 실패","이미지 업로드 중 오류가 발생했습니다.","error"),null)));return e&&e.data&&e.data.fileName?e.data.fileName:null},async updateFac(){if(!this.rowData.fac_code)return void N().fire("수정 불가","수정할 설비를 선택하세요.","warning");if(!this.rowData.fac_pattern&&!this.rowData.fac_status&&!this.rowData.install_date&&!this.rowData.model_name)return void N().fire("입력 오류","필수 항목을 모두 입력해주세요.","warning");if(!this.rowData.fac_pattern)return void N().fire("입력 오류","설비유형을 선택해주세요.","warning");if(!this.rowData.fac_status)return void N().fire("입력 오류","설비상태를 선택해주세요.","warning");if(!this.rowData.install_date)return void N().fire("입력 오류","설치일자를 입력해주세요.","warning");if(!this.rowData.model_name)return void N().fire("입력 오류","설비이름을 입력해주세요.","warning");const a=await this.uploadImage();a&&(this.rowData.image=a),I.A.put("/api/fac/updateFac",this.rowData).then((a=>{a&&a.data&&1==a.data.result?N().fire("수정 완료","설비 정보가 수정되었습니다.","success").then((()=>{this.facList(),this.autoFacCode(),this.clearForm()})):N().fire("수정 실패","설비 수정에 실패했습니다.","error")})).catch((a=>{console.error("수정 실패:",a),N().fire("오류 발생","설비 수정 중 오류가 발생했습니다.","error")}))},getImageUrl(a){return a?a.startsWith("data:image")?a:`http://localhost:3000/uploads/facImages/${a}`:""},onImageChange(a){const e=a.target.files[0];if(!e)return;const t=["image/jpeg","image/png","image/svg+xml","image/jpg"];if(!t.includes(e.type))return N().fire("업로드 불가","이미지 파일만 등록 가능합니다. (jpg, png, svg)","warning"),void(this.$refs.fileInput.value="");this.imageFile=e;const l=new FileReader;l.onload=a=>{this.rowData.imagePreview=a.target.result},l.readAsDataURL(e)},async deleteFac(){this.rowData.fac_code?N().fire({title:"정말 삭제하시겠습니까?",text:`설비 코드: ${this.rowData.fac_code}`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"삭제",cancelButtonText:"취소"}).then((a=>{a.isConfirmed&&I.A.delete(`/api/fac/delFac/${this.rowData.fac_code}`).then((a=>{a&&a.data&&a.data.affectedRows>0?N().fire("삭제 완료","설비 정보가 삭제되었습니다.","success").then((()=>{this.facList(),this.clearForm()})):N().fire("삭제 실패","설비 삭제에 실패했습니다.","error")})).catch((a=>{console.error("삭제 오류:",a),N().fire("오류 발생","삭제 중 오류가 발생했습니다.","error")}))})):N().fire("삭제 불가","삭제할 설비를 선택하세요.","warning")}}},V=t(6262);const U=(0,V.A)(S,[["render",F],["__scopeId","data-v-537da4b3"]]);var B=U}}]);
//# sourceMappingURL=682.15c47c15.js.map