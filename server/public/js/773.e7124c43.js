"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[773],{7773:function(e,t,a){a.r(t),a.d(t,{default:function(){return j}});var o=a(641),s=a(3751);const i={class:"ag-theme-alpine",style:{height:"400px",width:"100%"}},l={class:"d-flex justify-content-end me-5"},n={class:"input-group mb-3 w-50"};function c(e,t,a,c,r,d){const m=(0,o.g2)("CModalHeader"),h=(0,o.g2)("AgGridVue"),u=(0,o.g2)("CModalBody"),p=(0,o.g2)("CButton"),f=(0,o.g2)("CModalFooter"),k=(0,o.g2)("CModal");return(0,o.uX)(),(0,o.Wv)(k,{visible:a.visible,onClose:d.close,backdrop:"static",alignment:"center",size:"xl",style:{"min-width":"1000px"}},{default:(0,o.k6)((()=>[(0,o.bF)(m,null,{default:(0,o.k6)((()=>[(0,o.RG)(e.$slots,"header",{},(()=>[t[4]||(t[4]=(0,o.eW)("업체 목록"))]),!0)])),_:3}),(0,o.bF)(u,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",i,[(0,o.Lk)("div",l,[(0,o.Lk)("div",n,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.searchType=e),class:"form-select","aria-label":"Default select example"},t[5]||(t[5]=[(0,o.Lk)("option",{value:" m.mat_lot",selected:""},"LOT",-1),(0,o.Lk)("option",{value:"mat_name"},"자재명",-1),(0,o.Lk)("option",{value:"r.store_name"},"창고명",-1)]),512),[[s.u1,r.searchType]]),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>r.searchText=e),placeholder:"검색어 입력",class:"form-control w-50",style:{width:"30%"},onKeydown:t[2]||(t[2]=(0,s.jR)(((...e)=>d.searchMaterials&&d.searchMaterials(...e)),["enter"]))},null,544),[[s.Jo,r.searchText]]),(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>d.searchMaterials&&d.searchMaterials(...e)),class:"btn btn-primary"},t[6]||(t[6]=[(0,o.Lk)("i",{class:"pi pi-search"},null,-1)]))])]),(0,o.bF)(h,{style:{width:"100%",height:"100%"},class:"ag-theme-alpine",columnDefs:r.columnDefs,rowData:r.rowData,gridOptions:r.gridOptions,onRowClicked:d.clicked},null,8,["columnDefs","rowData","gridOptions","onRowClicked"])])])),_:1}),(0,o.bF)(f,null,{default:(0,o.k6)((()=>[(0,o.RG)(e.$slots,"footer",{},(()=>[(0,o.bF)(p,{color:"secondary",onClick:d.close},{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)("닫기")]))),_:1},8,["onClick"])]),!0)])),_:3})])),_:3},8,["visible","onClose"])}var r=a(7654),d=a(4335),m=a(8465),h=a.n(m),u={components:{AgGridVue:r.b,Swal:h()},props:{visible:{type:Boolean,required:!0}},data(){return{rowData:[],searchType:" m.mat_lot",searchText:"",columnDefs:[{field:"mat_lot",headerName:"lot",flex:1},{field:"mat_code",headerName:"자재코드",flex:1},{field:"mat_name",headerName:"자재명",flex:1},{field:"storage_code",headerName:"창고코드",flex:1},{field:"store_name",headerName:"창고명",flex:1},{field:"mat_check_pass",headerName:"입고가능수량",flex:1},{field:"check_code",headerName:"검수코드",flex:1},{field:"store_quantity",headerName:"입고량",flex:1}],gridOptions:{domLayout:"autoHeight",singleClickEdit:!0,suppressRowClickSelection:!0,pagination:!0,paginationPageSize:5,paginationPageSizeSelector:!1,overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,cellStyle:{textAlign:"center"}}}}},mounted(){this.matList()},methods:{close(){this.$emit("close")},matList(){d.A.get("/api/mat/storeListModal").then((e=>{this.rowData=e.data})).catch((e=>{console.error(e)}))},searchMaterials(){d.A.get("/api/mat/storeListModal",{params:{type:this.searchType,keyword:this.searchText}}).then((e=>{this.rowData=e.data})).catch((e=>{console.error(e)}))},async clicked(e){let t=await d.A.get("/api/mat/matUseCheck/"+e.data.mat_lot);console.log(t.data.useCheck),t.data[0].useCheck>0?h().fire({title:"실패",text:"이미 자재가 소모된 건입니다.",icon:"error",confirmButtonText:"확인"}):(this.$emit("selectOrder",e.data),this.close())}},watch:{visible(e){e&&this.matList()}}},p=a(6262);const f=(0,p.A)(u,[["render",c],["__scopeId","data-v-2d5a6b28"]]);var k=f,_=a(5122),y=a(33);const b={class:"card border-0",style:{height:"800px"}},g={class:"text-end mt-3 mb-3"},L={class:"row"},x={class:"ag-theme-alpine col me-5",style:{height:"400px",width:"50%"}},w={class:"d-flex justify-content-start"},v={class:"input-group mb-5",style:{width:"65%"}},C={class:"card border-0 col",style:{height:"650px","background-color":"#F5F5F5"}},T={class:"row"},A={class:"input-group mb-5 col"},D={class:"input-group mb-5 col"},S={class:"row"},R={class:"input-group mb-5 col"},U={class:"input-group mb-5 col"},V={class:"row"},F={class:"input-group mb-5 col"},N=["value"],M={class:"input-group mb-5 col"},B={class:"row"},O={class:"input-group col"},q={class:"input-group mb-5 col"},z=["value"];function J(e,t,a,i,l,n){const c=_.A,r=(0,o.g2)("AgGridVue"),d=k;return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",b,[t[24]||(t[24]=(0,o.Lk)("div",{class:"font-semibold text-xl mb-4"},"자재입고관리",-1)),(0,o.Lk)("div",g,[(0,o.bF)(c,{label:"조회",severity:"success",class:"me-3",onClick:n.searchStore},null,8,["onClick"]),(0,o.bF)(c,{label:"등록",severity:"info",class:"me-3",onClick:n.addStore},null,8,["onClick"]),(0,o.bF)(c,{label:"수정",severity:"help",class:"me-3",onClick:n.updateStore},null,8,["onClick"]),(0,o.bF)(c,{label:"삭제",severity:"danger",class:"me-5",onClick:n.deleteStore},null,8,["onClick"])]),(0,o.Lk)("div",L,[(0,o.Lk)("div",x,[(0,o.Lk)("div",w,[(0,o.Lk)("div",v,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.searchType=e),class:"form-select","aria-label":"Default select example"},t[12]||(t[12]=[(0,o.Lk)("option",{value:"mat_name",selected:""},"자재명",-1),(0,o.Lk)("option",{value:"o.mat_order_code"},"발주코드",-1),(0,o.Lk)("option",{value:"company_name"},"업체명",-1),(0,o.Lk)("option",{value:"m.check_code"},"검수코드",-1)]),512),[[s.u1,l.searchType]]),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>l.searchText=e),placeholder:"검색어 입력",class:"form-control w-50",style:{width:"100%"},onKeydown:t[2]||(t[2]=(0,s.jR)(((...e)=>n.searchReadyList&&n.searchReadyList(...e)),["enter"]))},null,544),[[s.Jo,l.searchText]]),(0,o.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>n.searchReadyList&&n.searchReadyList(...e)),class:"btn btn-primary"},t[13]||(t[13]=[(0,o.Lk)("i",{class:"pi pi-search"},null,-1)]))])]),(0,o.bF)(r,{style:{width:"100%",height:"100%"},class:"ag-theme-alpine",columnDefs:l.columnDefs,rowData:l.rowData,gridOptions:l.gridOptions,onRowClicked:n.clicked},null,8,["columnDefs","rowData","gridOptions","onRowClicked"])]),(0,o.Lk)("div",C,[t[23]||(t[23]=(0,o.Lk)("h5",null,"입고등록",-1)),(0,o.Lk)("div",T,[(0,o.Lk)("div",A,[t[14]||(t[14]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"LOT",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",placeholder:"LOT","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":t[4]||(t[4]=e=>l.info.mat_lot=e),readonly:""},null,512),[[s.Jo,l.info.mat_lot]])]),(0,o.Lk)("div",D,[t[15]||(t[15]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"담당자",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",placeholder:"담당자","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":t[5]||(t[5]=e=>l.info.emp_name=e),readonly:""},null,512),[[s.Jo,l.info.emp_name]])])]),(0,o.Lk)("div",S,[(0,o.Lk)("div",R,[t[16]||(t[16]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"자재코드",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",placeholder:"자재코드","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":t[6]||(t[6]=e=>l.info.mat_code=e),readonly:""},null,512),[[s.Jo,l.info.mat_code]])]),(0,o.Lk)("div",U,[t[17]||(t[17]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"자재명",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",placeholder:"자재명","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":t[7]||(t[7]=e=>l.info.mat_name=e),readonly:""},null,512),[[s.Jo,l.info.mat_name]])])]),(0,o.Lk)("div",V,[(0,o.Lk)("div",F,[t[18]||(t[18]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"입고가능수량",-1)),(0,o.Lk)("input",{type:"text",class:"form-control",placeholder:"입고가능수량","aria-label":"Username","aria-describedby":"basic-addon1",value:n.formatAleady,readonly:""},null,8,N)]),(0,o.Lk)("div",M,[t[19]||(t[19]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"입고수량",-1)),(0,o.bo)((0,o.Lk)("input",{type:"number",class:"form-control",placeholder:"입고수량","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":t[8]||(t[8]=e=>l.info.store_quantity=e)},null,512),[[s.Jo,l.info.store_quantity]])])]),(0,o.Lk)("div",B,[(0,o.Lk)("div",O,[t[20]||(t[20]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"비고",-1)),(0,o.bo)((0,o.Lk)("textarea",{class:"form-control","onUpdate:modelValue":t[9]||(t[9]=e=>l.info.note=e),placeholder:"비고",style:{height:"100px",resize:"none"}},null,512),[[s.Jo,l.info.note]])]),(0,o.Lk)("div",q,[t[22]||(t[22]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"창고",-1)),(0,o.bo)((0,o.Lk)("select",{class:"form-select col","aria-label":"Default select example","onUpdate:modelValue":t[10]||(t[10]=e=>l.info.storage_code=e)},[t[21]||(t[21]=(0,o.Lk)("option",{disabled:"",selected:"",value:""},"창고(선택)",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.storeListAry,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.storage_code,value:e.storage_code},(0,y.v_)(e.store_name),9,z)))),128))],512),[[s.u1,l.info.storage_code]])])])])])]),(0,o.bF)(d,{visible:l.showModal,rowSelection:"multiple",onClose:t[11]||(t[11]=e=>l.showModal=!1),onSelectOrder:n.orderSelected},null,8,["visible","onSelectOrder"])],64)}var G=a(4783),$={components:{AgGridVue:r.b,Swal:h(),StoreList:k},data(){return{rowData:[],searchType:"mat_name",searchText:"",columnDefs:[{field:"mat_code",headerName:"자재코드",flex:1},{field:"mat_name",headerName:"자재명",flex:1},{field:"mat_order_code",headerName:"발주코드",flex:1},{field:"company_name",headerName:"업체명",flex:1},{field:"check_code",headerName:"검수코드",hide:!0},{field:"mat_check_pass",headerName:"입고가능수량",flex:1,valueFormatter:e=>null!=e.value?`${e.value}개`:""}],gridOptions:{domLayout:"autoHeight",singleClickEdit:!0,suppressRowClickSelection:!0,pagination:!0,paginationPageSize:8,paginationPageSizeSelector:!1,overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,cellStyle:{textAlign:"center"}}},info:{mat_lot:"",emp_name:(0,G.k)().empName,emp_code:(0,G.k)().id,mat_code:"",mat_name:"",mat_check_pass:"",store_quantity:"",check_code:"",note:"",storage_code:""},storeListAry:[],showModal:!1}},mounted(){this.readyList(),this.lotAuto(),this.storeList()},computed:{formatAleady(){return""==this.info.mat_check_pass?this.info.mat_check_pass:this.info.mat_check_pass+"개"}},watch:{"info.store_quantity":function(e){this.info.mat_check_pass<this.info.store_quantity&&(this.info.store_quantity=this.info.mat_check_pass,alert("입고가능수량보다 입고량이 넘을 수 없습니다."))}},methods:{close(){this.$emit("close")},async readyList(){await d.A.get("/api/mat/storeReadyList").then((e=>{this.rowData=e.data})).catch((e=>{console.error(e)}))},async searchReadyList(){await d.A.get("/api/mat/storeReadyList",{params:{type:this.searchType,keyword:this.searchText}}).then((e=>{this.rowData=e.data})).catch((e=>{console.error(e)}))},async storageCheck(){let e=await d.A.get("/api/mat/storeCount/"+this.info.mat_lot).catch((e=>{console.log(e)}));return e.data.countCheck},async lotAuto(){await d.A.get("/api/mat/matLotAuto").then((e=>{this.info.mat_lot=e.data.mat_lot})).catch((e=>{console.log(e)}))},clicked(e){this.info.mat_name=e.data.mat_name,this.info.mat_code=e.data.mat_code,this.info.mat_check_pass=e.data.mat_check_pass,this.info.check_code=e.data.check_code,this.info.emp_code=(0,G.k)().id,this.info.emp_name=(0,G.k)().empName},async storeList(){await d.A.get("/api/mat/storeList").then((e=>{console.log(e.data),this.storeListAry=e.data}))},async addStore(){if(""==this.info.store_quantity||""==this.info.storage_code||""==this.info.mat_code)return void h().fire({title:"실패",text:"해당하는 값을 입력해주십시오",icon:"error",confirmButtonText:"확인"});let e=await this.storageCheck();e>0?h().fire({title:"실패",text:"이미 등록이 진행된 건 입니다.",icon:"error",confirmButtonText:"확인"}):await d.A.post("/api/mat/storeAdd",this.info).then((e=>{e.data.affectedRows>0?(h().fire({title:"성공",text:"등록이 성공하였습니다",icon:"success",confirmButtonText:"확인"}),this.resetValue(),this.readyList(),this.lotAuto()):h().fire({title:"실패",text:"등록이 실패하였습니다.",icon:"error",confirmButtonText:"확인"})}))},async searchStore(){this.showModal=!0},async orderSelected(e){this.info.mat_lot=e.mat_lot,this.info.mat_code=e.mat_code,this.info.mat_name=e.mat_name,this.info.mat_check_pass=e.mat_check_pass,this.info.store_quantity=e.store_quantity,this.info.check_code=e.check_code,this.info.storage_code=e.storage_code},resetValue(){this.info.mat_lot="",this.info.mat_code="",this.info.mat_name="",this.info.mat_check_pass="",this.info.store_quantity="",this.info.check_code="",this.info.storage_code=""},async updateStore(){if(""==this.info.store_quantity||""==this.info.storage_code||""==this.info.mat_code)return void h().fire({title:"실패",text:"해당하는 값을 입력해주십시오",icon:"error",confirmButtonText:"확인"});let e=await this.storageCheck();e<1?h().fire({title:"실패",text:"등록이 되지 않은 건입니다.",icon:"error",confirmButtonText:"확인"}):await d.A.put("/api/mat/storeUpdate",this.info).then((e=>{e.data.affectedRows>0?(h().fire({title:"수정",text:"수정이 완료되었습니다.",icon:"success",confirmButtonText:"확인"}),this.resetValue(),this.readyList(),this.lotAuto()):h().fire({title:"수정실패",text:"수정이 실패하였습니다",icon:"error",confirmButtonText:"확인"})})).catch((e=>console.log(e)))},async deleteStore(){let e=await this.storageCheck();e<1?h().fire({title:"실패",text:"등록이 되지 않은 건입니다.",icon:"error",confirmButtonText:"확인"}):await d.A.delete("/api/mat/storeDelete/"+this.info.mat_lot).then((e=>{e.data.affectedRows>0?(h().fire({title:"삭제",text:"삭제기 완료되었습니다.",icon:"success",confirmButtonText:"확인"}),this.resetValue(),this.readyList(),this.lotAuto()):h().fire({title:"삭제실패",text:"삭제가 실패하였습니다",icon:"error",confirmButtonText:"확인"})}))}}};const E=(0,p.A)($,[["render",J],["__scopeId","data-v-a5aececc"]]);var j=E}}]);
//# sourceMappingURL=773.e7124c43.js.map