"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[864],{5864:function(e,t,o){o.r(t),o.d(t,{default:function(){return k}});var r=o(5122),a=o(641);const i={class:"card border-0 h-100"},n={class:"text-end mt-3 mb-3",style:{"padding-right":"2%"}},l={class:"par-grid"},d={class:"prod-grid"},s={class:"prodcheck-grid"};function c(e,t,o,c,u,p){const h=r.A,f=(0,a.g2)("ag-grid-vue");return(0,a.uX)(),(0,a.CE)("div",i,[t[2]||(t[2]=(0,a.Lk)("div",{class:"font-semibold text-xl mb-4"},"제품검수",-1)),t[3]||(t[3]=(0,a.Lk)("div",{class:"d-flex justify-content-start me-5"},null,-1)),(0,a.Lk)("div",n,[(0,a.bF)(h,{label:"초기화",severity:"help",class:"me-3",onClick:p.resetList},null,8,["onClick"]),(0,a.bF)(h,{label:"저장",severity:"info",class:"me-3",onClick:p.prodCheckSave},null,8,["onClick"])]),(0,a.Lk)("div",l,[(0,a.Lk)("div",d,[t[0]||(t[0]=(0,a.Lk)("h5",null,"제품목록",-1)),(0,a.bF)(f,{style:{width:"650px",height:"500px"},class:"ag-theme-alpine",columnDefs:u.columnDefs,rowData:u.rowData,gridOptions:u.gridOptions,defaultColDef:e.defaultColDef,onCellClicked:p.prodCellClicked},null,8,["columnDefs","rowData","gridOptions","defaultColDef","onCellClicked"])]),(0,a.Lk)("div",s,[t[1]||(t[1]=(0,a.Lk)("h5",null,"제품검수",-1)),(0,a.bF)(f,{style:{width:"780px",height:"500px"},ref:"secondGrid",class:"ag-theme-alpine",columnDefs:u.columnDefs2,rowData:u.rowData2,gridOptions:u.gridOptions2,onCellValueChanged:p.testChange,rowSelection:"multiple",defaultColDef:e.defaultColDef2,onGridReady:p.onSecondGridReady,pinnedBottomRowData:u.bottomRow},null,8,["columnDefs","rowData","gridOptions","onCellValueChanged","defaultColDef","onGridReady","pinnedBottomRowData"])])])])}o(8111),o(8237);var u=o(7654),p=o(4335),h=o(8465),f=o.n(h),_={components:{AgGridVue:u.b,Swal:f()},data(){return{rowData:[{prod_code:"",prod_name:"",work_lot:"",quantity:""}],columnDefs:[{field:"prod_code",headerName:"제품코드",flex:3},{field:"prod_name",headerName:"제품명",flex:4},{field:"work_lot",headerName:"공정LOT",flex:3},{field:"quantity",headerName:"생산량 ",flex:2}],gridOptions:{pagination:!0,paginationPageSize:5,paginationPageSizeSelector:[5,10,20,50],overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,onGridReady:function(e){e.api.sizeColumnsToFit()}}},rowData2:[{work_lot:"",prod_check_code:"",prod_code:"",prod_name:"",check_list:"부품 누락",pass_quantity:"",error_quantity:""},{work_lot:"",prod_check_code:"",prod_code:"",prod_name:"",check_list:"외관",pass_quantity:"",error_quantity:""},{work_lot:"",prod_check_code:"",prod_code:"",prod_name:"",check_list:"포장상태",pass_quantity:"",error_quantity:""}],columnDefs2:[{field:"work_lot",headerName:"공정LOT",flex:3},{field:"prod_code",headerName:"제품코드",flex:3},{field:"prod_name",headerName:"제품명",flex:4},{field:"check_list",headerName:"검수항목",flex:3},{field:"pass_quantity",headerName:"합격량",flex:2},{field:"error_quantity",headerName:"불량량",flex:2,editable:!0}],gridOptions2:{domLayout:"autoHeight",suppressRowClickSelection:!0,overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,onGridReady:function(e){e.api.sizeColumnsToFit()}}},selectedSecondIndex:null,prodIndex:null,firstIndex:null,bottomRow:[{work_lot:"합계",prod_code:null,prod_name:null,check_list:null,pass_quantity:null,error_quantity:null}]}},mounted(){this.prodcheckData()},methods:{onSecondGridReady(e){this.gridOptions2.api=e.api},async prodcheckData(){try{const e=await p.A.get("/api/qual/prodcheck");this.rowData=e.data,this.rowData=[...this.rowData]}catch(e){console.error("데이터 조회 실패:",e)}},prodCellClicked(e){this.firstIndex=e.rowIndex;let t=e.data.prod_code,o=e.data.prod_name,r=e.data.work_lot;for(let a of this.rowData2)a.work_lot=r,a.prod_name=o,a.prod_code=t,a.pass_quantity="",a.error_quantity="";this.rowData2=[...this.rowData2],this.prodIndex=e.rowIndex},testChange(e){let t=e.rowIndex;this.rowData2[t].error_quantity=e.data.error_quantity;let o=0;for(let r of this.rowData2)o+=Number(r.error_quantity);o>Number(this.rowData[this.firstIndex].quantity)&&(f().fire({title:"실패",text:"검수량 보다 값이 많습니다.",icon:"error",confirmButtonText:"확인"}),this.rowData2[t].error_quantity=0,this.rowData2=[...this.rowData2]),this.bottomRow=[{work_lot:"합계",prod_code:null,prod_name:null,check_list:null,error_quantity:this.rowData2.reduce(((e,t)=>e+Number(t.error_quantity)),0),pass_quantity:Number(this.rowData[this.firstIndex].quantity)-this.rowData2.reduce(((e,t)=>e+Number(t.error_quantity)),0)}],this.rowData2=[...this.rowData2]},async prodCheckSave(){for(let e of this.rowData2)if(""==e.work_lot||""==e.prod_code||""==e.prod_name||""==e.check_list||""==e.error_quantity)return void f().fire({title:"실패",text:"값을 다 입력해주세요",icon:"error",confirmButtonText:"확인"});await p.A.post("/api/qual/prodchecksave",{insertErrorCheck:this.bottomRow,insertProdCheck:this.rowData2}).then((e=>{e.data.affectedRows>0?(f().fire({title:"등록 성공",text:"정상적으로 등록이 완료되었습니다.",icon:"success",confirmButtonText:"확인"}),this.bottomRow=[]):f().fire({title:"등록 실패",text:"등록이 실패하였습니다..",icon:"error",confirmButtonText:"확인"})})).catch((e=>{console.error(e),f().fire({title:"등록 실패",text:"알수 없는 오류가 발생하였습니다..",icon:"error",confirmButtonText:"확인"})}));this.rowData2=[{work_lot:"",prod_check_code:"",prod_code:"",prod_name:"",check_list:"부품 누락",pass_quantity:"",error_quantity:""},{work_lot:"",prod_check_code:"",prod_code:"",prod_name:"",check_list:"외관",pass_quantity:"",error_quantity:""},{work_lot:"",prod_check_code:"",prod_code:"",prod_name:"",check_list:"포장상태",pass_quantity:"",error_quantity:""}],await this.prodcheckData(),this.rowData=[...this.rowData]},resetList(){this.rowData2=[]}}},w=o(6262);const m=(0,w.A)(_,[["render",c],["__scopeId","data-v-dd58856e"]]);var k=m},8237:function(e,t,o){var r=o(6518),a=o(2652),i=o(9306),n=o(8551),l=o(1767),d=o(9539),s=o(4549),c=o(8745),u=o(9039),p=TypeError,h=u((function(){[].keys().reduce((function(){}),void 0)})),f=!h&&s("reduce",p);r({target:"Iterator",proto:!0,real:!0,forced:h||f},{reduce:function(e){n(this);try{i(e)}catch(u){d(this,"throw",u)}var t=arguments.length<2,o=t?void 0:arguments[1];if(f)return c(f,this,t?[e]:[e,o]);var r=l(this),s=0;if(a(r,(function(r){t?(t=!1,o=r):o=e(o,r,s),s++}),{IS_RECORD:!0}),t)throw new p("Reduce of empty iterator with no initial value");return o}})},8745:function(e,t,o){var r=o(616),a=Function.prototype,i=a.apply,n=a.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?n.bind(i):function(){return n.apply(i,arguments)})}}]);
//# sourceMappingURL=864.3088afe8.js.map