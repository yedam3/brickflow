"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[915],{1915:function(t,e,o){o.r(e),o.d(e,{default:function(){return q}});var r=o(5122),s=o(641),n=o(33);const i={class:"card border-0",style:{height:"calc(100vh - 8rem)"}},c={class:"table table-bordered text-center mt-3"},a={class:"table table-bordered text-center"},l={colspan:"2"},d={class:"row text-center mt-4"},u={class:"container d-flex justify-content-center mt-5"},p={class:"card p-3",style:{width:"600px"}},f={class:"row row-cols-3 g-2 text-center"},h=["onClick"],_={class:"d-flex justify-content-center mt-4 gap-3"};function k(t,e,o,k,y,I){const m=r.A;return(0,s.uX)(),(0,s.CE)("div",i,[e[11]||(e[11]=(0,s.Lk)("h3",null,"공정 진행 관리",-1)),e[12]||(e[12]=(0,s.Lk)("div",{class:"heading-with-line mb-2"},[(0,s.Lk)("h5",{class:"m-0 me-3"},"제어")],-1)),(0,s.Lk)("table",c,[e[6]||(e[6]=(0,s.Lk)("thead",{class:"table-warning"},[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"공정명"),(0,s.Lk)("th",null,"설비명"),(0,s.Lk)("th",null,"제품명"),(0,s.Lk)("th",null,"작업자명"),(0,s.Lk)("th",null,"기작업량"),(0,s.Lk)("th",null,"미작업량")])],-1)),(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,(0,n.v_)(this.processInfo.process_name),1),(0,s.Lk)("td",null,(0,n.v_)(this.processInfo.model_name),1),(0,s.Lk)("td",null,(0,n.v_)(this.processInfo.prod_name),1),(0,s.Lk)("td",null,(0,n.v_)(this.processInfo.emp_name),1),(0,s.Lk)("td",null,(0,n.v_)(this.processInfo.processed_quantity),1),(0,s.Lk)("td",null,(0,n.v_)(this.processInfo.unprocessed_quantity),1)])])]),(0,s.Lk)("table",a,[e[7]||(e[7]=(0,s.Lk)("thead",{class:"table-warning"},[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"투입량"),(0,s.Lk)("th",null,"불량량"),(0,s.Lk)("th",null,"생산량"),(0,s.Lk)("th",{colspan:"2"},"작업시작일시"),(0,s.Lk)("th",{colspan:"2"},"작업종료일시")])],-1)),(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("td",null,(0,n.v_)(this.processInfo.input_quantity),1),(0,s.Lk)("td",null,(0,n.v_)(this.processInfo.error_quantity),1),(0,s.Lk)("td",null,(0,n.v_)(this.processInfo.created_quantity),1),(0,s.Lk)("td",l,(0,n.v_)(this.processInfo.work_start_date),1),(0,s.Lk)("td",null,(0,n.v_)(this.processInfo.work_end_date),1)])])]),(0,s.Lk)("div",d,[(0,s.Lk)("div",{class:"col-4",onClick:e[0]||(e[0]=t=>I.setFocus("input_quantity"))},[e[8]||(e[8]=(0,s.Lk)("div",{class:"border p-2 bg-warning text-white"},"투입량",-1)),(0,s.Lk)("div",{class:(0,n.C4)(["border p-2",{"bg-white":"input_quantity"!==y.focusedField,"bg-primary text-white fw-bold border-3 border-primary":"input_quantity"===y.focusedField}])},(0,n.v_)("input_quantity"===y.focusedField?y.currentInput:y.processInfo.input_quantity),3)]),(0,s.Lk)("div",{class:"col-4",onClick:e[1]||(e[1]=t=>I.setFocus("error_quantity"))},[e[9]||(e[9]=(0,s.Lk)("div",{class:"border p-2 bg-warning text-white"},"불량량",-1)),(0,s.Lk)("div",{class:(0,n.C4)(["border p-2",{"bg-white":"error_quantity"!==y.focusedField,"bg-danger text-white fw-bold border-3 border-danger":"error_quantity"===y.focusedField}])},(0,n.v_)("error_quantity"===y.focusedField?y.currentInput:y.processInfo.error_quantity),3)]),(0,s.Lk)("div",{class:"col-4",onClick:e[2]||(e[2]=t=>I.setFocus("created_quantity"))},[e[10]||(e[10]=(0,s.Lk)("div",{class:"border p-2 bg-warning text-white"},"생산량",-1)),(0,s.Lk)("div",{class:(0,n.C4)(["border p-2",{"bg-white":"created_quantity"!==y.focusedField,"bg-success text-white fw-bold border-3 border-success":"created_quantity"===y.focusedField}])},(0,n.v_)("created_quantity"===y.focusedField?y.currentInput:y.processInfo.created_quantity),3)])]),(0,s.Lk)("div",u,[(0,s.Lk)("div",p,[(0,s.Lk)("div",f,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["1","2","3","4","5","6","7","8","9"],(t=>(0,s.Lk)("div",{class:"col border py-3 keypad",key:t,onClick:e=>I.handleKey(t)},(0,n.v_)(t),9,h))),64)),(0,s.Lk)("div",{class:"col border py-3 keypad-backspace",onClick:e[3]||(e[3]=t=>I.handleKey("<"))}," < "),(0,s.Lk)("div",{class:"col border py-3 keypad-zero",onClick:e[4]||(e[4]=t=>I.handleKey("0"))}," 0 "),(0,s.Lk)("div",{class:"col border py-3 keypad-enter",onClick:e[5]||(e[5]=t=>I.handleKey("✓"))}," ✓ ")])])]),(0,s.Lk)("div",_,[(0,s.bF)(m,{label:"작업 시작",severity:"primary",class:"",size:"large",style:{width:"20rem",height:"5rem"},onClick:I.processStart},null,8,["onClick"]),(0,s.bF)(m,{label:"작업 종료",severity:"info",class:"",size:"large",style:{width:"20rem",height:"5rem"},onClick:I.processEnd},null,8,["onClick"])])])}o(4114);var y=o(4335),I=o(8465),m=o.n(I),w={components:{},data(){return{work_lot:null,emp_code:null,fac_code:null,focusedField:null,currentInput:null,pressedKey:null,processInfo:{work_lot:"",process_code:"",process_name:"",fac_code:"",model_name:"",prod_code:"",prod_name:"",emp_code:"",emp_name:"",processed_quantity:"",unprocessed_quantity:"",order_quantity:"",input_quantity:"",error_quantity:"",created_quantity:"",process_sequence:"",work_start_date:"",work_end_date:""}}},watch(){},mounted(){const t=this.$route.query;"undefined"!==typeof t.work_lot&&(this.processInfo.work_lot=t.work_lot,this.processInfo.emp_code=t.emp_code,this.processInfo.fac_code=t.fac_code,this.displayLoad())},methods:{setFocus(t){null!==this.processInfo.work_start_date&&""!==this.processInfo.work_start_date||"error_quantity"!=t?null!==this.processInfo.work_start_date&&""!==this.processInfo.work_start_date||"created_quantity"!=t?null===this.processInfo.work_start_date||""===this.processInfo.work_start_date||"input_quantity"!=t?this.focusedField==t?this.focusedField=null:(this.focusedField=t,this.currentInput=0===this.processInfo[t]?"":this.processInfo[t].toString()):m().fire({title:"오류",text:"작업 시작 이후에는 투입 수량을 입력할 수 없습니다.",icon:"error",confirmButtonText:"확인"}):m().fire({title:"오류",text:"작업 시작 이전에는 생산 수량을 입력할 수 없습니다.",icon:"error",confirmButtonText:"확인"}):m().fire({title:"오류",text:"작업 시작 이전에는 불량 수량을 입력할 수 없습니다.",icon:"error",confirmButtonText:"확인"})},handleKey(t){"<"===t?this.backspace():"✓"===t?this.confirmInput():this.appendNumber(t),this.pressedKey=t,setTimeout((()=>{this.pressedKey=null}),300)},appendNumber(t){this.focusedField&&(this.currentInput+=t)},backspace(){this.focusedField&&(this.currentInput=this.currentInput.slice(0,-1))},confirmInput(){if(this.focusedField){const t=parseInt(this.currentInput)||0;this.processInfo[this.focusedField]=t,this.focusedField=null,this.currentInput=""}},getKeyStyle(t){return this.pressedKey===t.toString()?{cursor:"pointer",backgroundColor:"#0d6efd",color:"white",fontWeight:"bold",border:"3px solid #0d6efd",boxShadow:"0 0 10px rgba(13, 110, 253, 0.5)",transition:"all 0.1s ease-in-out"}:{backgroundColor:"0"===t?"#212529":"white",color:"0"===t?"white":"black"}},async displayLoad(){let t=this.processInfo.work_lot;console.log(this.processInfo),await y.A.get("/api/work/process/select",{params:{work_lot:this.processInfo.work_lot,emp_code:this.processInfo.emp_code,fac_code:this.processInfo.fac_code}}).then((e=>{console.log(e.data),console.log(this.processInfo),this.processInfo=e.data,this.processInfo.work_lot=t})).catch((t=>console.error(t)))},async processStart(){0!==this.processInfo.input_quantity?this.processInfo.input_quantity<=0?m().fire({title:"오류",text:"투입량은 0이 될 수 없습니다.",icon:"error",confirmButtonText:"확인"}):this.processInfo.input_quantity>this.processInfo.unprocessed_quantity?m().fire({title:"오류",text:"투입량은 미작업량을 초과할 수 없습니다.",icon:"error",confirmButtonText:"확인"}):this.processInfo.work_start_date?m().fire({title:"오류",text:"해당 작업은 이미 시작된 상태입니다.",icon:"error",confirmButtonText:"확인"}):await y.A.post("/api/work/process/start",{work_lot:this.processInfo.work_lot,fac_code:this.processInfo.fac_code,employee_code:this.processInfo.emp_code,input_quantity:this.processInfo.input_quantity}).then((t=>{const e=new Date;this.processInfo.work_start_date=this.formatDate(e),0===t.data[1][0].result_code?(m().fire({title:"성공",text:"작업이 문제 없이 시작되었습니다.",icon:"success",confirmButtonText:"확인"}),this.processInfo["created_quantity"]=this.processInfo["input_quantity"]-this.processInfo[["error_quantity"]]):m().fire({title:"오류",text:"작업 시작에 실패했습니다.",icon:"error",confirmButtonText:"확인"})})).catch((t=>{console.error(t),m().fire({title:"오류",text:"작업 시작 과정에서 오류가 발생했습니다.",icon:"error",confirmButtonText:"확인"})})):m().fire({title:"오류",text:"투입량을 기입하세요.",icon:"error",confirmButtonText:"확인"})},async processEnd(){this.processInfo.work_start_date?this.processInfo.input_quantity<this.processInfo.error_quantity+this.processInfo.created_quantity?m().fire({title:"오류",text:"불량 수량과 생산 수량의 합계가 투입 수량보다 많습니다.",icon:"error",confirmButtonText:"확인"}):this.processInfo.input_quantity>this.processInfo.error_quantity+this.processInfo.created_quantity?m().fire({title:"오류",text:"불량 수량과 생산 수량의 합이 투입 수량보다 적습니다.",icon:"error",confirmButtonText:"확인"}):await y.A.post("/api/work/process/end",{work_lot:this.processInfo.work_lot,fac_code:this.processInfo.fac_code,employee_code:this.processInfo.emp_code,error_quantity:this.processInfo.error_quantity,created_quantity:this.processInfo.created_quantity}).then((t=>{const e=new Date;this.processInfo.work_end_date=this.formatDate(e),0===t.data[1][0].result_code?(m().fire({title:"성공",text:"작업이 문제 없이 종료되었습니다.",icon:"success",confirmButtonText:"확인"}),this.$router.push({name:"Process"})):m().fire({title:"오류",text:"작업 종료에 실패했습니다.",icon:"error",confirmButtonText:"확인"})})).catch((t=>{console.error(t),m().fire({title:"오류",text:"작업 종료 과정에서 오류가 발생했습니다.",icon:"error",confirmButtonText:"확인"})})):m().fire({title:"오류",text:"작업이 시작되지 않은 상태에서는 종료가 불가능합니다.",icon:"error",confirmButtonText:"확인"})},formatDate(t){const e=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0"),i=String(t.getSeconds()).padStart(2,"0");return`${e}-${o}-${r} ${s}:${n}:${i}`}}},b=o(6262);const L=(0,b.A)(w,[["render",k]]);var q=L}}]);
//# sourceMappingURL=915.8f3e6f0f.js.map