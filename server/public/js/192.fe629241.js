"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[192],{192:function(a,e,t){t.r(e),t.d(e,{default:function(){return I}});var r=t(5122),o=t(641),i=t(3751),s=t(33);const l={class:"card border-0",style:{height:"calc(50vh - 5rem)"}},n={class:"card border-0",style:{height:"calc(50vh - 5rem)"}},c={class:"row mb-4"},d={class:"input-group col"},u={class:"input-group col"},p={class:"row mb-4"},f={class:"input-group col"},_={class:"input-group col"},h={class:"input-group col"},y={class:"row mb-4"},m={class:"input-group col"},w=["value"],k={class:"input-group col"},b={class:"input-group col"},g={class:"row mb-4"},D={class:"input-group col"},v={class:"input-group col"},L={class:"input-group col"};function x(a,e,t,x,C,A){const R=(0,o.g2)("ag-grid-vue"),F=r.A;return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",l,[e[10]||(e[10]=(0,o.Lk)("h2",null,"설비 관리",-1)),e[11]||(e[11]=(0,o.Lk)("div",{class:"heading-with-line"},[(0,o.Lk)("h5",{class:"m-0 me-3"},"설비 목록")],-1)),(0,o.bF)(R,{class:"ag-theme-alpine custom-grid-theme",style:{width:"100%",height:"300px"},columnDefs:C.columnDefs,rowData:C.rowData,gridOptions:C.gridOptions,onCellClicked:A.comCellClicked,onRowClicked:A.clicked},null,8,["columnDefs","rowData","gridOptions","onCellClicked","onRowClicked"])]),(0,o.Lk)("div",n,[e[23]||(e[23]=(0,o.Lk)("div",{class:"heading-with-line mb-4"},[(0,o.Lk)("h5",{class:"m-0 me-3"},"설비 수리 처리")],-1)),(0,o.Lk)("div",c,[(0,o.Lk)("div",d,[e[12]||(e[12]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"설비수리코드",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",placeholder:"","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":e[0]||(e[0]=a=>C.rowData2.repaire_code=a),readonly:""},null,512),[[i.Jo,C.rowData2.repaire_code]])]),(0,o.Lk)("div",u,[e[13]||(e[13]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"담당자",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",placeholder:"담당자","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":e[1]||(e[1]=a=>C.rowData2.employee_name=a),readonly:""},null,512),[[i.Jo,C.rowData2.employee_name]])])]),(0,o.Lk)("div",p,[(0,o.Lk)("div",f,[e[14]||(e[14]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},[(0,o.eW)("수리등록일자"),(0,o.Lk)("small",{style:{color:"gray"}},"(필수)")],-1)),(0,o.bo)((0,o.Lk)("input",{type:"date",class:"form-control",placeholder:"연도-월-일","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":e[2]||(e[2]=a=>C.rowData2.repaire_add_date=a)},null,512),[[i.Jo,C.rowData2.repaire_add_date]])]),(0,o.Lk)("div",_,[e[15]||(e[15]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},[(0,o.eW)("수리처리일자"),(0,o.Lk)("small",{style:{color:"gray"}},"(필수)")],-1)),(0,o.bo)((0,o.Lk)("input",{type:"date",class:"form-control",placeholder:"연도-월-일","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":e[3]||(e[3]=a=>C.rowData2.repaire_finish_date=a)},null,512),[[i.Jo,C.rowData2.repaire_finish_date]])]),(0,o.Lk)("div",h,[e[16]||(e[16]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"설비코드",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",placeholder:"설비코드","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":e[4]||(e[4]=a=>C.rowData2.fac_code=a),readonly:""},null,512),[[i.Jo,C.rowData2.fac_code]])])]),(0,o.Lk)("div",y,[(0,o.Lk)("div",m,[e[18]||(e[18]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},[(0,o.eW)("수리결과"),(0,o.Lk)("small",{style:{color:"gray"}},"(필수)")],-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":e[5]||(e[5]=a=>C.rowData2.fac_result=a),class:"form-select col","aria-label":"Default select example"},[e[17]||(e[17]=(0,o.Lk)("option",{disabled:"",value:"",style:{color:"gray"}},"수리결과",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(C.facResultAry,(a=>((0,o.uX)(),(0,o.CE)("option",{key:a.fac_result,value:a.fac_result},(0,s.v_)(a.sub_code_name),9,w)))),128))],512),[[i.u1,C.rowData2.fac_result]])]),(0,o.Lk)("div",k,[e[19]||(e[19]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},[(0,o.eW)("고장증상"),(0,o.Lk)("small",{style:{color:"gray"}},"(필수)")],-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",placeholder:"고장증상","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":e[6]||(e[6]=a=>C.rowData2.break_status=a)},null,512),[[i.Jo,C.rowData2.break_status]])]),(0,o.Lk)("div",b,[e[20]||(e[20]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},"비가동코드",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text",class:"form-control",placeholder:"비가동코드","aria-label":"Username","aria-describedby":"basic-addon1","onUpdate:modelValue":e[7]||(e[7]=a=>C.rowData2.unplay_code=a),readonly:""},null,512),[[i.Jo,C.rowData2.unplay_code]])])]),(0,o.Lk)("div",g,[(0,o.Lk)("div",D,[e[21]||(e[21]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},[(0,o.eW)("비고"),(0,o.Lk)("small",{style:{color:"gray"}},"(필수)")],-1)),(0,o.bo)((0,o.Lk)("textarea",{class:"form-control",placeholder:"비고","onUpdate:modelValue":e[8]||(e[8]=a=>C.rowData2.note=a),style:{height:"100px",resize:"none"}},null,512),[[i.Jo,C.rowData2.note]])]),(0,o.Lk)("div",v,[e[22]||(e[22]=(0,o.Lk)("span",{class:"input-group-text",id:"basic-addon1"},[(0,o.eW)("수리내역"),(0,o.Lk)("small",{style:{color:"gray"}},"(필수)")],-1)),(0,o.bo)((0,o.Lk)("textarea",{class:"form-control",placeholder:"수리내역","onUpdate:modelValue":e[9]||(e[9]=a=>C.rowData2.fac_history=a),style:{height:"100px",resize:"none"}},null,512),[[i.Jo,C.rowData2.fac_history]])])]),(0,o.Lk)("div",L,[(0,o.bF)(F,{label:"처리",severity:"info",class:"me-3",onClick:A.addRepaire},null,8,["onClick"])])])],64)}t(8111),t(2489),t(116);var C=t(5093),A=t.n(C),R=t(7654),F=t(2772),U=t(4335),Y=t(8465),H=t.n(Y),V=t(4783),N={components:{AgGridVue:R.b,datePicker:F.A},data(){return{rowData:[{unplay_code:"",unplay_reason_code:"",employee_code:(0,V.k)().id,employee_name:(0,V.k)().empName,unplay_start_date:"",note:"",fac_code:""}],rowData2:{repaire_code:"",employee_code:(0,V.k)().id,employee_name:(0,V.k)().empName,repaire_add_date:"",repaire_finish_date:"",fac_code:"",fac_result:"",break_status:"",unplay_code:"",note:"",fac_history:""},columnDefs:[{field:"fac_code",headerName:"설비코드",flex:3},{field:"unplay_code",headerName:"비가동설비코드",flex:3},{field:"unplay_reason_code",headerName:"비가동사유코드",flex:3,valueFormatter:a=>{if(Array.isArray(this.reasonFacAry)){const e=this.reasonFacAry.find((e=>e.unplay_reason_code===a.value));return e?e.sub_code_name:a.value}return a.value}},{field:"employee_code",headerName:"당담자",flex:3,valueFormatter:a=>a.data?.employee_name||a.value},{field:"unplay_start_date",headerName:"비가동시작일시",flex:3},{field:"note",headerName:"비고",flex:3}],gridOptions:{domLayout:"autoHeight",singleClickEdit:!0,suppressRowClickSelection:!0,pagination:!0,paginationPageSize:5,paginationPageSizeSelector:!1,overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,cellStyle:{textAlign:"center"}}},facResultAry:[{fac_result:"수리완료",sub_code:"OH1"}]}},mounted(){this.autoReCode(),this.repaireList(),this.facResult(),this.reasonFac(),this.resetRowData2()},methods:{comCellClicked(a){console.log("셀 클릭됨:",a)},resetRowData2(){this.rowData2={repaire_code:"",repaire_add_date:"",repaire_finish_date:"",employee_code:(0,V.k)().id,employee_name:(0,V.k)().empName,fac_code:"",break_status:"",fac_result:"",unplay_code:"",note:"",fac_history:""}},async autoReCode(){const a=await U.A.get("/api/fac/autoReCode");Array.isArray(a.data)&&a.data.length>0?this.rowData2.repaire_code=a.data[0].repaire_code:(console.warn("수리코드를 받아오지 못했습니다:",a.data),this.rowData2.repaire_code="코드없음")},async addRepaire(){const{employee_code:a,repaire_add_date:e,break_status:t,fac_code:r,fac_result:o,unplay_code:i,fac_history:s}=this.rowData2;if(!a||!e||!t||!r||!o||!i||!s)return void H().fire("입력 오류","모든 필수 항목을 입력해주세요.","warning");this.rowData2.employee_code||H().fire("입력오류","담당자를 입력해주세요","warning"),this.rowData2.repaire_add_date||H().fire("입력오류","종료일시를 입력해주세요","warning"),this.rowData2.break_status||H().fire("입력오류","고장증상을 입력해주세요","warning"),this.rowData2.fac_code||H().fire("입력오류","설비코드를 입력해주세요","warning"),this.rowData2.fac_result||H().fire("입력오류","수리결과를 선택해주세요","warning"),this.rowData2.unplay_code||H().fire("입력오류","비가동코드를 입력해주세요","warning"),this.rowData2.fac_history||H().fire("입력오류","수리내역을 입력해주세요","warning"),this.rowData2.repaire_add_date||(this.rowData2.repaire_add_date=A()().format("YYYY-MM-DD")),this.rowData2.repaire_finish_date||(this.rowData2.repaire_finish_date=A()().format("YYYY-MM-DD")),this.rowData2.repaire_finish_date=A()().format("YYYY-MM-DD");const l=A()().format("YYYY-MM-DD HH:mm");await this.autoReCode(),console.log("전송될 데이터:",this.rowData2),U.A.post("/api/fac/repaireFac",{repaireFac:{repaire_code:this.rowData2.repaire_code,employee_code:(0,V.k)().id,repaire_add_date:this.rowData2.repaire_add_date,repaire_finish_date:this.rowData2.repaire_finish_date,fac_code:this.rowData2.fac_code,fac_result:this.rowData2.fac_result,break_status:this.rowData2.break_status,unplay_code:this.rowData2.unplay_code,note:this.rowData2.note,fac_history:this.rowData2.fac_history}}).then((async a=>{a.data.affectedRows>0?("OH1"===this.rowData2.fac_result&&(await U.A.put("/api/fac/updateList",{facStatus:"FS1",facCode:this.rowData2.fac_code}),await U.A.put("/api/fac/updateUnplayEndDate",{unplay_code:this.rowData2.unplay_code,unplay_end_date:l})),H().fire({title:"처리 완료",text:"수리 등록이 완료되었습니다.",icon:"success",confirmButtonText:"확인"}),this.repaireList(),this.resetRowData2(),await this.autoReCode()):H().fire("실패","수리 등록 실패","error")}))},async repaireList(){await U.A.get("/api/fac/repaireList",{}).then((a=>{console.log("API 응답 데이터:",a.data),console.log(a.data),this.rowData=a.data.filter((a=>"OH1"!==a.fac_result))}))},async clicked(a){console.log(a.data);const e=a.data;this.rowData2={...e,repaire_code:"",repaire_add_date:"",repaire_finish_date:"",fac_history:"",break_status:"",fac_result:""},await this.autoReCode()},async facResult(){await U.A.get("/api/fac/facResult").then((a=>{this.facResultAry=a.data})).catch((a=>console.error(a)))},async reasonFac(){await U.A.get("/api/fac/reasonFac").then((a=>{console.log(a.data),this.reasonFacAry=a.data,this.reasonFacAry=[...a.data]})).catch((a=>console.error(a)))}}},J=t(6262);const M=(0,J.A)(N,[["render",x],["__scopeId","data-v-70c4c259"]]);var I=M},2489:function(a,e,t){var r=t(6518),o=t(9565),i=t(9306),s=t(8551),l=t(1767),n=t(9462),c=t(6319),d=t(6395),u=t(9539),p=t(4549),f=!d&&p("filter",TypeError),_=n((function(){var a,e,t,r=this.iterator,i=this.predicate,l=this.next;while(1){if(a=s(o(l,r)),e=this.done=!!a.done,e)return;if(t=a.value,c(r,i,[t,this.counter++],!0))return t}}));r({target:"Iterator",proto:!0,real:!0,forced:d||f},{filter:function(a){s(this);try{i(a)}catch(e){u(this,"throw",e)}return f?o(f,this,a):new _(l(this),{predicate:a})}})},2529:function(a){a.exports=function(a,e){return{value:a,done:e}}},6279:function(a,e,t){var r=t(6840);a.exports=function(a,e,t){for(var o in e)r(a,o,e[o],t);return a}},6319:function(a,e,t){var r=t(8551),o=t(9539);a.exports=function(a,e,t,i){try{return i?e(r(t)[0],t[1]):e(t)}catch(s){o(a,"throw",s)}}},9462:function(a,e,t){var r=t(9565),o=t(2360),i=t(6699),s=t(6279),l=t(8227),n=t(1181),c=t(5966),d=t(7657).IteratorPrototype,u=t(2529),p=t(9539),f=l("toStringTag"),_="IteratorHelper",h="WrapForValidIterator",y=n.set,m=function(a){var e=n.getterFor(a?h:_);return s(o(d),{next:function(){var t=e(this);if(a)return t.nextHandler();if(t.done)return u(void 0,!0);try{var r=t.nextHandler();return t.returnHandlerResult?r:u(r,t.done)}catch(o){throw t.done=!0,o}},return:function(){var t=e(this),o=t.iterator;if(t.done=!0,a){var i=c(o,"return");return i?r(i,o):u(void 0,!0)}if(t.inner)try{p(t.inner.iterator,"normal")}catch(s){return p(o,"throw",s)}return o&&p(o,"normal"),u(void 0,!0)}})},w=m(!0),k=m(!1);i(k,f,"Iterator Helper"),a.exports=function(a,e,t){var r=function(r,o){o?(o.iterator=r.iterator,o.next=r.next):o=r,o.type=e?h:_,o.returnHandlerResult=!!t,o.nextHandler=a,o.counter=0,o.done=!1,y(this,o)};return r.prototype=e?w:k,r}}}]);
//# sourceMappingURL=192.fe629241.js.map