"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[7],{3007:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var o=a(5122),s=a(641);const n={class:"card border-0",style:{height:"800px"}},r={class:"text-end mt-3 mb-3"},l={class:"ag-wrapper d-flex justify-content-center"},i={class:"ag-wrapper float-start ms-5"};function d(e,t,a,d,c,u){const h=o.A,f=(0,s.g2)("ag-grid-vue");return(0,s.uX)(),(0,s.CE)("div",n,[t[0]||(t[0]=(0,s.Lk)("div",{class:"font-semibold text-xl mb-4"},"공정검사",-1)),t[1]||(t[1]=(0,s.Lk)("h4",{class:"text-start"},"공정검사대기항목",-1)),(0,s.Lk)("div",r,[(0,s.bF)(h,{label:"조회",severity:"success",class:"me-3"}),(0,s.bF)(h,{label:"등록",severity:"info",class:"me-3",onClick:u.addTest},null,8,["onClick"]),(0,s.bF)(h,{label:"수정",severity:"help",class:"me-3"}),(0,s.bF)(h,{label:"삭제",severity:"danger",class:"me-5"})]),(0,s.Lk)("div",l,[(0,s.bF)(f,{class:"ag-theme-alpine custom-grid-theme",style:{width:"95%"},columnDefs:c.columnDefs,rowData:c.rowData,gridOptions:c.gridOptions,rowSelection:"single",onCellClicked:u.onRowClicked,onCellValueChanged:u.inputRender},null,8,["columnDefs","rowData","gridOptions","onCellClicked","onCellValueChanged"])]),t[2]||(t[2]=(0,s.Lk)("div",{class:"text-end mt-5 ms-5 w-50"},[(0,s.Lk)("h4",{class:"text-start"},"공정검사실행")],-1)),(0,s.Lk)("div",i,[(0,s.bF)(f,{ref:"secondGrid",class:"ag-theme-alpine custom-grid-theme",style:{width:"100%",height:"150px"},columnDefs:c.secondColumnDefs,rowData:c.secondRowData,gridOptions:c.gridOptions2,rowSelection:"multiple",onCellValueChanged:u.testChange,onCellClicked:u.testValueclicked},null,8,["columnDefs","rowData","gridOptions","onCellValueChanged","onCellClicked"])])])}a(8111),a(7588),a(3579);var c=a(7654),u=a(4335),h=a(8465),f=a.n(h),p={components:{AgGridVue:c.b,Swal:f()},data(){return{rowData:[],rowDataIndex:null,grid2Index:null,columnDefs:[{field:"product_order_name",headerName:"생산지시명",flex:1},{field:"prod_code",headerName:"제품코드",flex:1},{field:"prod_name",headerName:"제품명",flex:1},{field:"process_code",headerName:"공정코드",flex:1},{field:"order_quantity",headerName:"지시량",flex:1,valueFormatter:e=>null!=e.value?`${e.value}개`:""},{field:"already_test",headerName:"기검사량",flex:1,valueFormatter:e=>null!=e.value?`${e.value}개`:""},{field:"not_test",headerName:"미검사량",flex:1,valueFormatter:e=>null!=e.value?`${e.value}개`:""},{field:"input_quantity",headerName:"현검사량",flex:1,editable:!0,valueFormatter:e=>e.value?`${e.value}개`:"",valueParser:e=>{const t=parseInt(e.newValue);return isNaN(t)?null:t}}],secondRowData:[],secondColumnDefs:[{field:"test_name",headerName:"검사명",flex:1},{field:"test_item",headerName:"검사항목",flex:1,editable:!0},{field:"input_quantity",headerName:"검사량",flex:1},{field:"pass_standard",headerName:"합격기준",flex:1},{field:"test_value",headerName:"검사수치",flex:1,editable:!0,valueParser:e=>{const t=parseInt(e.newValue);return isNaN(t)?null:t}},{field:"pass_or_not",headerName:"합격여부",flex:1,cellStyle:e=>"YN1"==e.value?{color:"#0284C7",textAlign:"center",fontWeight:"bold"}:"YN2"==e.value?{color:"#E02D2D",textAlign:"center",fontWeight:"bold"}:"YN3"==e.value?{color:"#6C757D",textAlign:"center",fontWeight:"bold"}:null,valueFormatter:e=>{let t="";return"YN1"==e.value?t="적합":"YN2"==e.value?t="부적합":"YN3"==e.value&&(t="검사항목제외"),t}},{field:"emp_code",headerName:"담당자",flex:1}],gridOptions:{domLayout:"autoHeight",singleClickEdit:!0,pagination:!0,paginationPageSize:5,paginationPageSizeSelector:!1,overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,cellStyle:{textAlign:"center"}}},gridOptions2:{domLayout:"autoHeight",singleClickEdit:!0,overlayNoRowsTemplate:"표시할 값이 없습니다.",defaultColDef:{suppressMovable:!0,resizable:!1,sortable:!1,cellStyle:{textAlign:"center"}}}}},mounted(){this.testReady()},methods:{inputRender(){if(this.rowData.forEach(((e,t)=>{t!=this.rowDataIndex&&(this.rowData[t].input_quantity="")})),Number(this.rowData[this.rowDataIndex].not_test)<Number(this.rowData[this.rowDataIndex].input_quantity))return this.rowData[this.rowDataIndex].input_quantity=0,this.rowData=[...this.rowData],void alert("미검사량 보다 더많은값을 기입할 수 없습니다.");this.secondRowData[0].input_quantity=this.rowData[this.rowDataIndex].input_quantity},async onRowClicked(e){this.rowDataIndex=e.rowIndex,u.A.get("/api/test/testMenu/"+e.data.process_code).then((e=>{for(let t of e.data)t.pass_or_not="",t.emp_code="",t.test_value="",t.input_quantity="",t.work_lot=this.rowData[this.rowDataIndex].work_lot,t.product_order_detail_code=this.rowData[this.rowDataIndex].product_order_detail_code,t.process_code=this.rowData[this.rowDataIndex].process_code,t.prod_code=this.rowData[this.rowDataIndex].prod_code;this.secondRowData=e.data})).catch((e=>console.log(e)))},async testReady(){await u.A.get("/api/test/storeReadyList/").then((e=>{this.rowData=e.data;for(let t of this.rowData)t.input_quantity=""})).catch((e=>console.log(e)))},testChange(e){if(0==e.data.input_quantity||""==e.data.input_quantity)return f().fire({title:"실패",text:"전 항목을 통과하지 못하였거나 기입을 안하여 해당 항목 기입이 불가능합니다.",icon:"error",confirmButtonText:"확인"}),void(e.data.test_value="");const t=e.data,a=Number(t.test_value),o=Number(t.pass_standard);if(t.pass_or_not=a>=o?"YN1":"YN2","YN1"==t.pass_or_not){const e=this.secondRowData[this.grid2Index+1];e&&(this.secondRowData[this.grid2Index+1].input_quantity=t.input_quantity)}let s=!1;for(let n=0;n<this.secondRowData.length;n++){const e=this.secondRowData[n];s?e.pass_or_not="YN3":"YN2"===e.pass_or_not&&(s=!0)}if(!this.secondRowData.some((e=>"YN2"===e.pass_or_not)))for(let n=0;n<this.secondRowData.length;n++)"YN3"===this.secondRowData[n].pass_or_not&&(this.secondRowData[n].pass_or_not="");this.secondRowData=[...this.secondRowData]},testValueclicked(e){this.grid2Index=e.rowIndex},async addTest(){if(0!=this.secondRowData.length){for(let e of this.secondRowData)if(!e.test_item||!e.pass_standard|!e.pass_or_not)return void f().fire({title:"실패",text:"해당하는 값을 입력해주십시오.",icon:"error",confirmButtonText:"확인"});await u.A.post("/api/test/addTest",this.secondRowData).then((e=>{console.log(e.data),"success"==e.data[e.data.length-1][0].result&&(f().fire({title:"성공",text:"등록에 성공하였습니다",icon:"success",confirmButtonText:"확인"}),this.testReady(),this.secondRowData=[])})).catch((e=>console.log(e)))}else f().fire({title:"실패",text:"해당하는 공정을 선택해주세요.",icon:"error",confirmButtonText:"확인"})}}},w=a(6262);const m=(0,w.A)(p,[["render",d],["__scopeId","data-v-47edc9d8"]]);var _=m},3579:function(e,t,a){var o=a(6518),s=a(9565),n=a(2652),r=a(9306),l=a(8551),i=a(1767),d=a(9539),c=a(4549),u=c("some",TypeError);o({target:"Iterator",proto:!0,real:!0,forced:u},{some:function(e){l(this);try{r(e)}catch(o){d(this,"throw",o)}if(u)return s(u,this,e);var t=i(this),a=0;return n(t,(function(t,o){if(e(t,a++))return o()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},7588:function(e,t,a){var o=a(6518),s=a(9565),n=a(2652),r=a(9306),l=a(8551),i=a(1767),d=a(9539),c=a(4549),u=c("forEach",TypeError);o({target:"Iterator",proto:!0,real:!0,forced:u},{forEach:function(e){l(this);try{r(e)}catch(o){d(this,"throw",o)}if(u)return s(u,this,e);var t=i(this),a=0;n(t,(function(t){e(t,a++)}),{IS_RECORD:!0})}})}}]);
//# sourceMappingURL=7.40399a01.js.map